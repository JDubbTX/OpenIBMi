---
layout: post
title:  "ILE CiCd - Part 3 - Configuring BOB"
date:   2023-05-08
excerpt: Building a full CiCd pipeline for ILE - Part 3 - Configuring the Better Object Builder (BOB)
author: john-weirich
draft: false
seo:
  title: ILE CiCd - Part 3 - Configuring BOB
  description:
  image: cicd_cropped.png
images: # relative to /src/assets/images/
  feature:
  thumb: cicd_cropped.png
  align: # object-center (default) - other options at https://tailwindcss.com/docs/object-position
  height: # optional. Default = h-48 md:h-1/3
---

*This post is continued from [ILE CiCd Pipeline with Gitlab - Part 2 - Local Development Setup](/2023/05/08/ile-cicd-part-2-local-development-setup).*

In the previous post, we created some source on our local PC, and set up the Code4i Actions that allow us to deploy the source and compile it on our IBM i partition.  Some of the source, however, does not have a built in action for compiling, so we must use an additional tool, called Bob.  Bob will also be used as our build tool in our CiCd pipeline.

## Introducing the Better Object Builder - Bob!

Better Object Builder, or Bob, is a tool for building your programs, etc.  It builds make files on the fly depending on which objects need to be built, while handling dependent objects as well.  

Bob is installed on the IBM i through the ACS Open Source Management tool, or through YUM RPM package manager.  Installation instructions are [here](https://ibm.github.io/ibmi-bob/#/getting-started/installation).

Bob requires a bit of project metadata in order to get it going, so lets begin by discussing the metadata files that are required.

### iproj.json

Create a file named iproj.json at the root of the project.  This file contains information about your project.  Here is a sample to get you started:

/iproj.json

```text
 {
    "version": "0.0.1",
    "description": "My First IBM i Project",
    "objlib": "&objlib",
    "curlib": "&objlib",
    "includePath": [""],
    "preUsrlibl": "",
    "postUsrlibl": "",
    "setIBMiEnvCmd": [""],
    "repository" : "https://gitlab.com/JDubbTX/my-first-ibm-i-project"
}
```

The important thing in this file is the objlib, which tells Bob where to put the compiled objects that it builds.  We use an environmental variable for this that is set in our .env file discussed below.  The other options are not mandatory, but you can read more about them in the Bob documentation [here](https://ibm.github.io/ibmi-bob/#/prepare-the-project/iproj-json).

</br>

### .env - Set up your Code4i environment
Technically this is a Code4i file, not a Bob file - but we will use it with Bob here.  Create a file named **.env** at the root of your project with contents similar to what is shown below, putting your target object library - the library where objects will be built - instead of *MYOBJLIB*.  In my case, one of the two libraries assigned to me with my [PUB400.COM](https://PUB400.COM) account was **JWEIRICH1**, so I used that.

/.env

```text
objlib=MYOBJLIB
```

</br>

### Rules.mk - Rules for building with Bob

**Bob** relies on several **Rules.mk** files so that you can specify how objects are to be built.  You will need a **Rules.mk** file at the root of your project that contains the name of all the source files.  You will also need one in each source directory that associates the source files in that directory with the name and object type of the object being built.

/Rules.mk (at project root)

```text
SUBDIRS = QCLLESRC QDTASRC QDDSSRC QRPGLESRC
```

This is the **Rules.mk** file at the project root which specifies each subdirectory that Bob will use for source files.

---

/QCLLESRC/Rules.mk

```text
MYCL.PGM: MYCL.PGM.CLLE
```

---

/QDTASRC/Rules.mk

```text
MYDTAQ.DTAARA: MYDTAQ.DTAARA
```

---

/QDDSSRC/Rules.mk

```text
MYDSPF.FILE: MYDSPF.DSPF
```

---

/QRPGLESRC/Rules.mk

```text
MYRPGLE.PGM: MYRPGLE.PGM.RPGLE MYDSPF.FILE
```

## Building with Bob in Vscode

Once all of the above metadata files are set up for your project, building with Bob in VSCODE is accomplished the exact same way that you did with Code4i actions in the previous post.

1. Focus (click on) the source file that you wish to build
2. Click on Build current, or Build All.
3. Click on your desired deployment method.
4. The source file will be deployed to the IBM i partition's IFS 'deploy workspace directory', then Bob will build.  Job Logs will be returned to your workspace, as well as any errors.

